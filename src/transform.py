import pandas as pd
from datetime import datetime


# рдлрдВрдХреНрд╢рдирдордзреНрдпреЗ lat рдЖрдгрд┐ lon рд╣реЗ рдирд╡реАрди рдкреЕрд░рд╛рдореАрдЯрд░реНрд╕ ре▓рдб рдХреЗрд▓реЗ рдЖрд╣реЗрдд
def clean_weather_data(raw_data, city, lat, lon):
    print(f"ЁЯЫая╕П {city} рд╕рд╛рдареА рдбреЗрдЯрд╛ рдХреНрд▓реАрдирд┐рдВрдЧ рд╕реБрд░реВ рдЖрд╣реЗ...")

    # рдбреЗрдЯрд╛рдлреНрд░реЗрдо рдмрдирд╡рдгреЗ
    df = pd.DataFrame([raw_data])

    # 1. рдирд╡реАрди рдХреЙрд▓рдо рдЬреЛрдбрдгреЗ (lat/lon рд╕рд╣)
    df['city'] = city
    df['lat'] = lat  # рдирдХрд╛рд╢рд╛рд╕рд╛рдареА рдорд╣рддреНрддреНрд╡рд╛рдЪреЗ
    df['lon'] = lon  # рдирдХрд╛рд╢рд╛рд╕рд╛рдареА рдорд╣рддреНрддреНрд╡рд╛рдЪреЗ
    df['processed_at'] = datetime.now().strftime("%Y-%m-%d %H:%M:%S")

    # 2. рдХреЙрд▓рдордЪреА рдирд╛рд╡реЗ рдиреАрдЯ рдХрд░рдгреЗ
    # рдЬрд░ рддреБрдордЪреНрдпрд╛ raw_data рдордзреНрдпреЗ 'temperature' рдирд╕реЗрд▓ рдЖрдгрд┐ 'current_weather' рдЕрд╕реЗрд▓ рддрд░ рд╣реЗ рдиреАрдЯ рдХрд░рд╛.
    # рдкрдг рддреБрдордЪреНрдпрд╛ рд╕рдзреНрдпрд╛рдЪреНрдпрд╛ рдХреЛрдбрдиреБрд╕рд╛рд░ рд╣реЗ рдмрд░реЛрдмрд░ рдЕрд╕рд╛рд╡реЗ:
    df = df[['city', 'lat', 'lon', 'time', 'temperature', 'windspeed', 'processed_at']]

    return df